<div class="report-FILEInfo" ng-if="success" >
    <style>
        .report-FILEInfo dl {
            margin-bottom: 2px;
        }

    </style>

    <uib-tabset active="active">
        <uib-tab index="$index" ng-repeat="result in content.results" heading="{{result.submodule_name}}" disable="tab.disabled">
            <br>
            <!--  Basic properties -->
            <div ng-if="result.submodule_name=='Basic properties'">
                <div class="panel-body">
                    <div ng-repeat="r in result.results" class="panel panel-primary">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                               {{r.submodule_section_header}}
                            </h4>
                        </div>
                        <div class="panel-body">
                            <dl class="dl-horizontal" ng-repeat="(k,v) in r.submodule_section_content">
                                <dt>{{k}}</dt>
                                <dd class="wrap">{{v}}</dd>
                            </dl>
                        </div>
                    </div>
                </div>
            </div>

            <!--  Oletools -->
            <div ng-if="result.submodule_name=='Oletools Submodule'">
                <div class="panel-body">
                    <div ng-repeat="r in result.results">
                        <uib-accordion ng-if="r.submodule_section_header=='Olevba'">

                            <!--Olevba analysis -->
                            <div uib-accordion-group class="panel-primary" heading="Olevba analysis" is-open="true" is-disabled="status.isFirstDisabled">
                                <div ng-if="r.submodule_section_content.analysis" class="table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th >Type</th>
                                                <th >Keyword</th>
                                                <th >Description</th>
                                            </tr>
                                        </thead>
                                        <tbody ng-repeat="l in r.submodule_section_content.analysis">
                                            <tr>
                                                <td>{{l.type}}</td>
                                                <td>{{l.keyword}}</td>
                                                <td>{{l.description}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- Macros -->
                            <div uib-accordion-group  class="panel-primary" heading="Macros" is-open="false">
                                <div ng-if="r.submodule_section_content.macros != ''" ng-repeat="m in r.submodule_section_content.macros">
                                    <dl class="dl-horizontal">
                                        <dt>vba_filename</dt>
                                        <dd class="wrap">{{m.vba_filename}}</dd>
                                    </dl>
                                    <dl class="dl-horizontal">
                                        <dt>ole_stream</dt>
                                        <dd class="wrap">{{m.ole_stream}}</dd>
                                    </dl>
                                    <dl class="dl-horizontal">
                                        <dt>code</dt>
                                        <dd class="wrap"><pre>{{m.code}}</pre></dd>
                                    </dl>
                                </div>
                            </div>

                            <!--Deobfuscated code -->
                            <div uib-accordion-group ng-if="r.submodule_section_content.code_deobfuscated != ''" class="panel-primary" heading="Deobfuscated code" is-open="false">
                                <pre>
                                    {{r.submodule_section_content.code_deobfuscated}}
                                </pre>
                            </div>
                        </uib-accordion>
                        <div class="panel panel-primary" ng-if="r.submodule_section_header=='Oletools DDE Analysis'">
                            <div class="panel-heading">
                                <h4 class="panel-title>"{{r.submodule_section_header}}</h4>
                            </div>
                            <div class="panel-body">
                                <dl class="dl-horizontal" ng-repeat="(k,v) in r.submodule_section_content">
                                    <dt>{{k}}</dt>
                                    <dd class="wrap"><pre>{{v}}</pre></dd>
                                </dl>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Outlook message parser -->
            <div ng-if="result.submodule_name=='Outlook mail Information'">
                <div class="panel-body">
                    <div ng-repeat="r in result.results" class="panel panel-primary">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                               {{r.submodule_section_header}}
                            </h4>
                        </div>
                        <div class="panel-body">
                            <dl class="dl-horizontal">
                                <dt>From</dt>
                                <dd class="wrap">{{r.submodule_section_content.from}}</dd>
                            </dl>
                            <dl class="dl-horizontal">
                                <dt>To</dt>
                                <dd class="wrap">{{r.submodule_section_content.to}}</dd>
                            </dl>
                            <dl class="dl-horizontal">
                                <dt>Cc</dt>
                                <dd class="wrap">{{r.submodule_section_content.cc}}</dd>
                            </dl>
                            <dl class="dl-horizontal">
                                <dt>Date</dt>
                                <dd class="wrap">{{r.submodule_section_content.date}}</dd>
                            </dl>
                            <dl class="dl-horizontal">
                                <dt>Subject</dt>
                                <dd class="wrap">{{r.submodule_section_content.subject}}</dd>
                            </dl>
                            <dl class="dl-horizontal">
                                <dt>Body</dt>
                                <dd class="wrap"><pre>{{r.submodule_section_content.body}}</pre></dd>
                            </dl>
                            <dl class="dl-horizontal">
                                <dt>Attachments</dt>
                                <dd class="wrap">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th >Filename</th>
                                                <th >SHA256</th>
                                            </tr>
                                        </thead>
                                        <tbody ng-repeat="a in r.submodule_section_content.attachments">
                                            <tr>
                                                <td>{{a.name}}</td>
                                                <td>{{a.sha256}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </dd>
                            </dl>
                            <dl class="dl-horizontal">
                                <dt>All Headers</dt>
                                <dd class="wrap"><pre>{{r.submodule_section_content.header}}</pre></dd>
                            </dl>
                        </div>
                    </div>
                </div>
            </div>
            <!-- PDF Information (PDFiD)-->
            <div ng-if="result.submodule_name=='PDF Information'">
                <div class="panel-body">
                    <div ng-repeat="r in result.results" class="panel panel-primary">
                        <div class="panel-heading" ng-if="r.submodule_section_header=='PDFiD Information'">
                            <h4 class="panel-title">
                               {{r.submodule_section_header}}
                            </h4>
                        </div>
                        <div class="panel-body">
                            <div ng-repeat="(k,v) in r.submodule_section_content[0].pdfid">
                                <dl class="dl-horizontal" ng-if="k!='keywords'">
                                    <dt>{{k}}</dt>
                                    <dd class="wrap">{{v}}</dd>
                                </dl>
                                <dl class="dl-horizontal" ng-if="k=='keywords'">
                                    <dt>{{k}}</dt>
                                    <dd class="wrap">
                                        <table class="table">
                                            <thead>
                                                <tr>
                                                    <th >name</th>
                                                    <th >hexcodecount</th>
                                                    <th >count</th>
                                                </tr>
                                            </thead>
                                            <tbody ng-repeat="a in v.keyword">
                                                <tr>
                                                    <td>{{a.name}}</td>
                                                    <td>{{a.hexcodecount}}</td>
                                                    <td>{{a.count}}</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </dd>
                                </dl>
                            </div>

                        </div>
                    </div>


                </div>
            </div>
            <!--Next submodule here -->
        </uib-tab>
    </uib-tabset>
</div>
